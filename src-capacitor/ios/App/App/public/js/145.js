"use strict";(self["webpackChunkcheap_quasar"]=self["webpackChunkcheap_quasar"]||[]).push([[145],{67145:function(t,e,o){o.r(e),o.d(e,{default:function(){return S}});o(62590),o(83296),o(89933);var n=o(59835),i=o(86970),a={class:"row justify-start"},c={key:0},s=["src","alt"],r={key:1},u=["src","alt"],d={class:"column items-center"},p={key:0,class:"column items-center q-mt-lg"},l={key:0,class:"q-mt-md text-subtitle1 text-center text-bold"},g={key:1,class:"q-mt-md text-subtitle1 text-center text-bold"};function m(t,e,o,m,h,f){var w=(0,n.up)("q-avatar"),C=(0,n.up)("q-btn"),v=(0,n.up)("q-item-label"),_=(0,n.up)("q-badge"),k=(0,n.up)("q-img"),q=(0,n.up)("q-page");return(0,n.wg)(),(0,n.j4)(q,null,{default:(0,n.w5)((function(){return[(0,n._)("div",a,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(h.topCoupons,(function(t){return(0,n.wg)(),(0,n.iD)("div",{key:t.id,class:"q-pa-lg column q-gutter-sm flex-center"},[1===t.hasCommission?((0,n.wg)(),(0,n.iD)("div",c,[(0,n.Wm)(C,{round:"",flat:"",onClick:function(e){return f.onClick(t.actId)}},{default:(0,n.w5)((function(){return[(0,n.Wm)(w,{size:"4.0em"},{default:(0,n.w5)((function(){return[(0,n._)("img",{src:t.picSmall,alt:t.name},null,8,s)]})),_:2},1024)]})),_:2},1032,["onClick"])])):((0,n.wg)(),(0,n.iD)("div",r,[(0,n.Wm)(C,{round:"",flat:""},{default:(0,n.w5)((function(){return[(0,n.Wm)(w,{size:"4.0em",onClick:function(e){return h.miniCodeImg=t.url}},{default:(0,n.w5)((function(){return[(0,n._)("img",{src:t.picSmall,alt:t.name},null,8,u)]})),_:2},1032,["onClick"])]})),_:2},1024)])),(0,n._)("div",d,[(0,n.Wm)(v,null,{default:(0,n.w5)((function(){return[(0,n.Uk)((0,i.zw)(t.name),1)]})),_:2},1024),(0,n.Wm)(v,{caption:""},{default:(0,n.w5)((function(){return[(0,n.Uk)((0,i.zw)(t.description)+" ",1),1===t.hasCommission?((0,n.wg)(),(0,n.j4)(_,{key:0,transparent:"",align:"middle",color:"pink-4"},{default:(0,n.w5)((function(){return[(0,n.Uk)(" 返利 ")]})),_:1})):(0,n.kq)("",!0)]})),_:2},1024)])])})),128))]),""!=h.miniCodeImg?((0,n.wg)(),(0,n.iD)("div",p,[(0,n.Wm)(k,{src:h.miniCodeImg,"spinner-color":"white",width:"200px"},null,8,["src"]),f.isWeixin()?((0,n.wg)(),(0,n.iD)("div",l,"长按二维码")):((0,n.wg)(),(0,n.iD)("div",g,"微信扫码"))])):(0,n.kq)("",!0)]})),_:1})}var h=o(46264),f=o.n(h),w=(o(34442),o(52519),o(11476),o(24972),o(4845),o(3746)),C=o(91569),v=o(26950),_=o(17779),k=(0,w.Q_)("coupons",{state:function(){return{topCoupons:[],coupons:[],isListEnd:!1,couponInfo:[],categoryInfo:[],userAgent:""}},actions:{getTopCoupons:function(){var t=this;return C.axios.post("".concat(o.g.config.local,"/coupon/top"),{}).then((function(e){_.log("getTopCoupons  return"),_.log(e.data.data),t.topCoupons=e.data.data,v.Z.hide()}))},getCouponPage:function(t,e,n,i){var a=this;return C.axios.post("".concat(o.g.config.local,"/coupon/page"),{}).then((function(t){a.coupons=t.data.data.records,_.log(),t.data.data.records.length<20&&(a.isListEnd=!0),a.maxPage=Math.ceil(t.data.data.total/t.data.data.size),_.log("this.maxPage "+a.maxPage)}))}}}),q=o(19302),y=o(65457),x=o(60499),b=o(17779),I={name:"CouponPage",props:["userInfo","actId"],data:function(){return{uid:0,miniCodeImg:"",topCoupons:[]}},computed:f()({},(0,w.rn)(k,{_topCoupons:"topCoupons",_coupons:"coupons",_userAgent:"userAgent"})),setup:function(){b.log("coupon page setup");var t=(0,q.Z)(),e="";e=t.platform.is.mobile?"mobile":"pc";var o=(0,x.iH)("领大额外卖券，边看电影边吃 —— 好家当"),n=(0,x.qj)({description:{name:"description",content:"领大额美团，饿了么大额外卖红包，还有各种线下福利。让你足不出户变看电影边吃外卖。"},keywords:{name:"keywords",content:"美团外卖券,饿了么外卖团,买菜优惠券,线下优惠券"},applicationdevice:{name:"applicable-device",content:e},ogtype:{property:"og:type",content:"article"},ogurl:{property:"og:url",content:"https://mall.hjdang.com/coupon"},ogtitle:{property:"og:title",content:"领大额外卖券，边看电影边吃 —— 好家当"},ogdescription:{property:"og:description",content:"领大额美团，饿了么大额外卖优惠券，还有各种线下福利。让你足不出户变看电影边吃外卖。"},ogimage:{property:"og:image",content:"https://mall.hjdang.com/hjd.png"},weibocreate:{name:"weibo:webpage:create_at",content:""},weiboupdate:{name:"weibo:webpage:update_at",content:""}});function i(t){o.value=t}return(0,y.Z)((function(){return{title:o,titleTemplate:function(t){return"".concat(t.value)},meta:n}})),{setAnotherTitle:i,meta:n}},preFetch:function(t){t.store,t.currentRoute,t.previousRoute,t.redirect,t.ssrContext,t.urlPath,t.publicPath;b.log("coupon page prefetch");k()},created:function(){b.log("coupon page created"),this.topCoupons=this._topCoupons},mounted:function(){var t=this;b.log("coupon page mounted");var e=window.screen.width;e>1023.99&&(this.isBigScreen=!0),0===Object.keys(this._topCoupons).length&&(this.$q.loading.show({delay:400}),this.getTopCoupons()),b.log("actId = ",this.actId),this.actId>0&&setTimeout((function(){t.onClick(t.actId)}),500)},methods:{getTopCoupons:function(){var t=this;this.$axios.post("".concat(o.g.config.domain,"/coupon/top"),{}).then((function(e){b.log(e.data.data),t.topCoupons=e.data.data,t.$q.loading.hide()}))},onClick:function(t){var e=this;if(this.uid=this.userInfo.userId,(null==this.uid||""==this.uid)&&this.$q.localStorage.has("userInfo")){var n=this.$q.localStorage.getItem("userInfo");this.uid=n.userId}if(void 0==this.uid||null==this.uid){if(!this.isWeixin())return void this.$emit("need-login");window.location.href="https://open.weixin.qq.com/connect/oauth2/authorize?appid=wxa249d330e183eb43&redirect_uri=https://".concat(o.g.config.domainPro,"/auth/").concat(t,"&response_type=code&scope=snsapi_userinfo&state=waimai#wechat_redirect")}this.$q.loading.show({delay:200}),this.$axios.post("".concat(o.g.config.domain,"/coupon/meituan/minicode"),{actId:t,sid:this.uid}).then((function(n){b.log(n.data),n.data.code<0?-102==n.data.code?e.isWeixin()?window.location.href="https://open.weixin.qq.com/connect/oauth2/authorize?appid=wxa249d330e183eb43&redirect_uri=https://".concat(o.g.config.domainPro,"/auth/").concat(t,"&response_type=code&scope=snsapi_userinfo&state=waimai#wechat_redirect"):e.$emit("need-login"):e.$q.notify({type:"negative",icon:"warning",message:"".concat(n.data.msg)}):(b.log(n.data.data.data),e.miniCodeImg=n.data.data.data),e.$q.loading.hide()}))},isWeixin:function(){var t;return t=window.navigator.userAgent.toLowerCase(),b.log(t),"micromessenger"==t.match(/MicroMessenger/i)}}},W=o(11639),$=o(69885),P=o(68879),Z=o(61357),j=o(33115),z=o(20990),D=o(70335),Q=o(69984),T=o.n(Q);const A=(0,W.Z)(I,[["render",m]]);var S=A;T()(I,"components",{QPage:$.Z,QBtn:P.Z,QAvatar:Z.Z,QItemLabel:j.Z,QBadge:z.Z,QImg:D.Z})}}]);