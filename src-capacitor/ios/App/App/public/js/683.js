"use strict";(self["webpackChunkcheap_quasar"]=self["webpackChunkcheap_quasar"]||[]).push([[683],{75639:function(e,t,a){a.r(t),a.d(t,{default:function(){return p}});var n=a(59835);function r(e,t,a,r,o,i){var l=(0,n.up)("q-route-tab"),u=(0,n.up)("q-tabs"),d=(0,n.up)("router-view"),s=(0,n.up)("q-page-container"),c=(0,n.up)("login-qr"),g=(0,n.up)("q-layout");return(0,n.wg)(),(0,n.j4)(g,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(u,{modelValue:o.selectedTab,"onUpdate:modelValue":t[0]||(t[0]=function(e){return o.selectedTab=e}),align:"center","active-color":"accent","indicator-color":"accent","content-class":"text-grey-10","narrow-indicator":"",shrink:""},{default:(0,n.w5)((function(){return[(0,n.Wm)(l,{to:{path:"/user/orderlist/all",query:{userId:e.$route.query.userId,status:"",type:e.$route.query.type}},label:"全部订单",name:"all"},null,8,["to"]),(0,n.Wm)(l,{to:{path:"/user/orderlist/unbalanced",query:{userId:e.$route.query.userId,status:0,type:e.$route.query.type}},label:"未结算",name:"unbalanced"},null,8,["to"]),(0,n.Wm)(l,{to:{path:"/user/orderlist/balanced",query:{userId:e.$route.query.userId,status:1,type:e.$route.query.type}},label:"已结算",name:"balanced"},null,8,["to"])]})),_:1},8,["modelValue"]),(0,n.Wm)(s,{class:"bg-primary items-center column"},{default:(0,n.w5)((function(){return[(0,n.Wm)(d,null,{default:(0,n.w5)((function(t){var a=t.Component;return[((0,n.wg)(),(0,n.j4)(n.Ob,null,[((0,n.wg)(),(0,n.j4)((0,n.LL)(a),{onNeedLogin:i.needLogin,ref:"order-list",key:e.$route.fullPath},null,40,["onNeedLogin"]))],1024))]})),_:1})]})),_:1}),(0,n.Wm)(c,{"is-loading-qr":o.isLoadingQr,onLoginCardChanged:i.loginCardChange,"login-card":o.loginCard,"wechat-qr":o.wechatQr,"is-persistent":!1},null,8,["is-loading-qr","onLoginCardChanged","login-card","wechat-qr"])]})),_:1})}a(52519),a(69665),a(4845);var o=a(86204),i=a(17779),l={components:{LoginQr:o.Z},data:function(){return{isLoadingQr:!1,loginCard:!1,wechatQr:"",selectedTab:"all"}},mounted:function(){i.log("OrderLayout mounted")},methods:{needLogin:function(){var e=this;i.log("needLogin is trigged:");var t=this.$q.localStorage.getItem("userInfo");void 0!==t&&null!==t&&this.$q.localStorage.remove("userInfo"),this.isLoadingQr=!0,this.loginCard=!0,this.$axios.post("".concat(a.g.config.domain,"/wechat/createQr"),{}).then((function(t){if(e.isLoadingQr=!1,0==t.data.code){e.wechatQr=t.data.data.qrUrl;var n=new Date;clearInterval(e.timer),e.timer=window.setInterval((function(){e.$axios.post("".concat(a.g.config.domain,"/user/getScanLoginInfo/").concat(t.data.data.sceneStr),{}).then((function(t){if(0==t.data.code)if(i.log("this.timer = "+e.timer),t.data.data.loginFlag)e.userName=t.data.data.nickname,e.avatar=t.data.data.avatar,e.isLogin=!0,e.$q.localStorage.set("userInfo",t.data.data),window.clearInterval(e.timer),e.loginCard=!1,void 0!=itemId&&e.$refs.child.$emit("logined",itemId);else{var a=new Date;a.getTime()-n.getTime()>6e5&&(i.log("二维码过期"),window.clearInterval(e.timer),e.$q.notify({type:"negative",message:"二维码已过期，2秒后跳转页面"}),setTimeout((function(){e.$router.push({path:"/"})}),2e3))}else e.$q.notify({type:"negative",message:t.data.msg}),i.log("that.timer = "+e.timer),window.clearInterval(e.timer),e.loginCard=!1}))}),1e3)}else e.$q.notify({type:"negative",message:t.data.msg}),e.loginCard=!1}))},loginCardChange:function(e){this.loginCard=e,this.isLoadingQr=!1,this.wechatQr="",clearInterval(this.timer)}}},u=a(11639),d=a(20249),s=a(47817),c=a(73333),g=a(12133),m=a(69984),h=a.n(m);const f=(0,u.Z)(l,[["render",r]]);var p=f;h()(l,"components",{QLayout:d.Z,QTabs:s.Z,QRouteTab:c.Z,QPageContainer:g.Z})}}]);