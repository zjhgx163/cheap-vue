"use strict";(self["webpackChunkcheap_quasar"]=self["webpackChunkcheap_quasar"]||[]).push([[232],{52589:function(e,t,a){a.r(t),a.d(t,{default:function(){return k}});a(95330),a(62590);var n=a(59835),i=a(86970),o={class:"flex-center bg-primary row"},r={class:"row q-pa-xs items-center justify-between"},s=["src"],c={class:"text-secondary text-bold YL__user_draw_text"},l={class:"text-secondary text-bold YL__user_draw_text",style:{"line-height":"2.4em !important"}},d={class:"col"},u=(0,n._)("div",{class:"text-secondary text-bold YL__user_draw_text"},"可提现金额",-1),g={class:"row justify-between q-gutter-sm"},h={class:"text-amber-11 col-auto YL__user_money text-bold"},f={key:0,class:"col q-mr-sm column items-center"};function w(e,t,a,w,m,v){var p=(0,n.up)("q-avatar"),_=(0,n.up)("q-chip"),q=(0,n.up)("q-banner"),I=(0,n.up)("router-view"),C=(0,n.up)("q-page-container"),x=(0,n.up)("login-qr"),y=(0,n.up)("q-layout");return(0,n.wg)(),(0,n.j4)(y,null,{default:(0,n.w5)((function(){return[(0,n._)("div",o,[(0,n.Wm)(q,{"inline-actions":"",class:"text-white bg-brown YL__750w"},{default:(0,n.w5)((function(){return[(0,n._)("div",r,[(0,n._)("div",{class:(0,i.C_)([v.avatarCol,"row justify-around"])},[(0,n.Wm)(p,{size:"3.2em"},{default:(0,n.w5)((function(){return[(0,n._)("img",{src:m.avatar},null,8,s)]})),_:1}),(0,n._)("div",null,[(0,n._)("div",c,(0,i.zw)(m.userInfo.username),1),(0,n._)("div",l," ID: "+(0,i.zw)(m.userInfo.inviteCode),1)])],2),(0,n._)("div",{class:(0,i.C_)(v.blankCol)},null,2),(0,n._)("div",d,[(0,n._)("div",null,[u,(0,n._)("div",g,[(0,n._)("div",h,(0,i.zw)(void 0!=m.userInfo.withdrawableAmount?m.userInfo.withdrawableAmount.toFixed(2):m.userInfo.withdrawableAmount),1),"account"==e.$route.name?((0,n.wg)(),(0,n.iD)("div",f,[(0,n.Wm)(_,{color:"accent text-bold","text-color":"white",icon:"account_balance_wallet",size:"0.65rem",clickable:"",onClick:v.goWithdraw},{default:(0,n.w5)((function(){return[(0,n.Uk)(" 去提现 ")]})),_:1},8,["onClick"])])):(0,n.kq)("",!0)])])])])]})),_:1})]),(0,n.Wm)(C,{class:"bg-primary flex-center"},{default:(0,n.w5)((function(){return[((0,n.wg)(),(0,n.j4)(I,{key:e.$route.fullPath,onNeedLogin:v.needLogin,userInfo:m.userInfo,ref:"child"},null,8,["onNeedLogin","userInfo"]))]})),_:1}),(0,n.Wm)(x,{"is-loading-qr":m.isLoadingQr,onLoginCardChanged:v.loginCardChange,"login-card":m.loginCard,"wechat-qr":m.wechatQr,"is-persistent":!1},null,8,["is-loading-qr","onLoginCardChanged","login-card","wechat-qr"])]})),_:1})}a(52519),a(69665),a(11476),a(24972),a(4845);var m=a(86204),v=a(17779),p={components:{LoginQr:m.Z},data:function(){return{user:"登陆/注册",avatar:"/static/not_login_user.png",userInfo:{},isLoadingQr:!1,loginCard:!1,wechatQr:"",isBigScreen:!1}},computed:{avatarCol:function(){return this.isBigScreen?"col-3":"col-5"},blankCol:function(){return this.isBigScreen?"col-5":"col-2"}},props:["code","state"],mounted:function(){var e=window.screen.width;if(e>1023.99&&(this.isBigScreen=!0),this.code)this.wechatLogin(this.code,this.state);else{if(this.$q.localStorage.has("userInfo")){var t=this.$q.localStorage.getItem("userInfo");v.log("userInfo  ",t),void 0!==t&&null!==t&&(this.userName=t.nickname,this.isLogin=!0,null!=t.headimgurl&&""!=t.headimgurl&&(this.avatar=t.headimgurl,this.user=t.nickname))}this.getUserAccountInfo()}},methods:{getUserAccountInfo:function(){var e=this;this.$q.loading.show({delay:200}),this.$axios.post("".concat(a.g.config.domain,"/user/account/get"),{}).then((function(t){t.data.code<0?-102==t.data.code?e.isWeixin()?window.location.href="https://open.weixin.qq.com/connect/oauth2/authorize?appid=wxa249d330e183eb43&redirect_uri=https://".concat(a.g.config.domainPro,"/user&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect"):(v.log("emit need-login"),e.$refs.child.$emit("need-login")):e.$q.notify({type:"negative",icon:"warning",message:"".concat(t.data.msg)}):e.userInfo=t.data.data,e.$q.loading.hide()}))},wechatLogin:function(e,t){var n=this;this.$q.loading.show({delay:200}),this.$axios.post("".concat(a.g.config.domain,"/wechat/accesstokenlogin"),{code:this.code,state:this.state}).then((function(e){v.log(e.data),n.avatar=e.data.headimgurl,n.user=e.data.nickname,n.userInfo=e.data,n.$q.localStorage.set("userInfo",e.data),n.$q.loading.hide()}))},needLogin:function(){var e=this;v.log("needLogin is trigged:");var t=this.$q.localStorage.getItem("userInfo");void 0!==t&&null!==t&&this.$q.localStorage.remove("userInfo"),this.isLoadingQr=!0,this.loginCard=!0,this.$axios.post("".concat(a.g.config.domain,"/wechat/createQr"),{}).then((function(t){if(e.isLoadingQr=!1,0==t.data.code){e.wechatQr=t.data.data.qrUrl;var n=new Date;clearInterval(e.timer),e.timer=window.setInterval((function(){e.$axios.post("".concat(a.g.config.domain,"/user/getScanLoginInfo/").concat(t.data.data.sceneStr),{}).then((function(t){if(0==t.data.code)if(v.log("this.timer = "+e.timer),t.data.data.loginFlag)e.userName=t.data.data.nickname,e.avatar=t.data.data.avatar,e.isLogin=!0,e.$q.localStorage.set("userInfo",t.data.data),window.clearInterval(e.timer),e.loginCard=!1,e.getUserAccountInfo();else{var a=new Date;a.getTime()-n.getTime()>6e5&&(v.log("二维码过期"),window.clearInterval(e.timer),e.$q.notify({type:"negative",message:"二维码已过期，2秒后跳转页面"}),setTimeout((function(){e.$router.push({path:"/"})}),2e3))}else e.$q.notify({type:"negative",message:t.data.msg}),v.log("that.timer = "+e.timer),window.clearInterval(e.timer),e.loginCard=!1}))}),1e3)}else e.$q.notify({type:"negative",message:t.data.msg}),e.loginCard=!1}))},goWithdraw:function(){v.log("go withdraw"),this.$router.push({path:"withdraw",name:"withdraw"})},loginCardChange:function(e){this.loginCard=e,this.isLoadingQr=!1,this.wechatQr="",clearInterval(this.timer)},isWeixin:function(){var e;return e=window.navigator.userAgent.toLowerCase(),v.log(e),"micromessenger"==e.match(/MicroMessenger/i)}}},_=a(11639),q=a(20249),I=a(47128),C=a(61357),x=a(57691),y=a(12133),L=a(69984),$=a.n(L);const b=(0,_.Z)(p,[["render",w]]);var k=b;$()(p,"components",{QLayout:q.Z,QBanner:I.Z,QAvatar:C.Z,QChip:x.Z,QPageContainer:y.Z})}}]);